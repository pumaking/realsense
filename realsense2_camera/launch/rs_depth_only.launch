<launch>
  <arg name="namespace"           default="camera"/>
  <arg name="manager"             default="realsense2_camera_manager"/>

  <!-- Camera device specific arguments -->

  <arg name="serial_no"           default=""/>
  <arg name="json_file_path"      default=""/>
  
  <arg name="depth_width"         default="424"/>
  <arg name="depth_height"        default="240"/>
  <arg name="enable_depth"        default="true"/>

  <arg name="infra1_width"        default="$(arg depth_width)"/>
  <arg name="infra1_height"       default="$(arg depth_height)"/>
  <arg name="enable_infra1"       default="true"/>

  <arg name="infra2_width"        default="$(arg depth_width)"/>
  <arg name="infra2_height"       default="$(arg depth_height)"/>
  <arg name="enable_infra2"       default="true"/>

  <arg name="depth_fps"           default="30"/>
  <arg name="infra1_fps"          default="$(arg depth_fps)"/>
  <arg name="infra2_fps"          default="$(arg depth_fps)"/>
  <arg name="enable_imu"          default="false"/>

  <arg name="enable_pointcloud"   default="true"/>
  <arg name="enable_sync"         default="false"/>
  <arg name="align_depth"         default="false"/>

  <!-- depth preset and auto exposure -->
  <arg name="depth_preset"        default="3"/>
  <arg name="depth_auto_exposure" default="true"/>

  <!-- rgbd_launch specific arguments -->

  <!-- Arguments for remapping all device namespaces -->
  <arg name="rgb"                             default="color" />
  <arg name="ir"                              default="infra1" />
  <arg name="depth"                           default="depth" />
  <arg name="depth_registered_pub"            default="depth_registered" />
  <arg name="depth_registered"                default="depth_registered" unless="$(arg align_depth)" />
  <arg name="depth_registered"                default="aligned_depth_to_color" if="$(arg align_depth)" />
  <arg name="depth_registered_filtered"       default="$(arg depth_registered)" />
  <arg name="projector"                       default="projector" />

  <!-- Disable bond topics by default -->
  <arg name="bond"                            default="false" />
  <arg name="respawn"                         default="$(arg bond)" />

  <!-- Processing Modules -->
  <arg name="rgb_processing"                  default="false"/>
  <arg name="debayer_processing"              default="false" />
  <arg name="ir_processing"                   default="false"/>
  <arg name="depth_processing"                default="true"/>
  <arg name="depth_registered_processing"     default="false"/>
  <arg name="disparity_processing"            default="false"/>
  <arg name="disparity_registered_processing" default="false"/>
  <arg name="hw_registered_processing"        default="$(arg align_depth)" />
  <arg name="sw_registered_processing"        default="false" unless="$(arg align_depth)" />
  <arg name="sw_registered_processing"        default="false" if="$(arg align_depth)" />

  <group ns="$(arg namespace)">

    <!-- Launch the camera device nodelet-->
    <include file="$(find realsense2_camera)/launch/includes/nodelet.launch.xml">
      <arg name="manager"                  value="$(arg manager)"/>
      <arg name="serial_no"                value="$(arg serial_no)"/>
      <arg name="json_file_path"           value="$(arg json_file_path)"/>
      <arg name="depth_preset"             value="$(arg depth_preset)"/>
      <arg name="depth_auto_exposure"      value="$(arg depth_auto_exposure)"/>

      <arg name="enable_pointcloud"        value="$(arg enable_pointcloud)"/>
      <arg name="enable_sync"              value="$(arg enable_sync)"/>
      <arg name="align_depth"              value="$(arg align_depth)"/>

      <arg name="depth_width"              value="$(arg depth_width)"/>
      <arg name="depth_height"             value="$(arg depth_height)"/>
      <arg name="enable_depth"             value="$(arg enable_depth)"/>

      <arg name="enable_color"             value="false"/>

      <arg name="infra1_width"             value="$(arg infra1_width)"/>
      <arg name="infra1_height"            value="$(arg infra1_height)"/>
      <arg name="enable_infra1"            value="$(arg enable_infra1)"/>

      <arg name="infra2_width"             value="$(arg infra2_width)"/>
      <arg name="infra2_height"            value="$(arg infra2_height)"/>
      <arg name="enable_infra2"            value="$(arg enable_infra2)"/>

      <arg name="fisheye_fps"              value="30"/>
      <arg name="depth_fps"                value="$(arg depth_fps)"/>
      <arg name="infra1_fps"               value="$(arg infra1_fps)"/>
      <arg name="infra2_fps"               value="$(arg infra2_fps)"/>
      <arg name="enable_imu"               value="$(arg enable_imu)"/>
    </include>

    <node pkg="nodelet" type="nodelet" name="points_xyz_hw_registered"
            args="load depth_image_proc/point_cloud_xyz $(arg manager) $(arg bond)" respawn="$(arg respawn)">
        <remap from="camera_info"             to="$(arg depth)/camera_info" />
        <remap from="image_rect" to="$(arg depth)/image_rect_raw" />
        <remap from="points"     to="/$(arg depth_registered_pub)/points_raw" />
      </node>

  </group>

</launch>
